import{c as g,a as S,j as f}from"./jsx-runtime-DzeBifHW.js";import{c as N,b as E,a as d,u as M,M as b}from"./use-suspense-DTYBca5u.js";import{u as p,a as y}from"./use-ref-effect-CG-PCi_3.js";import{e as Y}from"./core-abL_lBWD.js";function h(e,u,n,s){return e.addEventListener(u,n,s),()=>e.removeEventListener(u,n)}function v(e,u){const[n,s]=p([]);return y(()=>{const{current:r}=e;if(!r)return;const a=()=>s(r.assignedNodes().filter(t=>!(t instanceof b)&&(u?u(t):!0)));return a(),h(r,"slotchange",a)},[e]),n}function x(e,u){const n=M(),s=v(e,u),[r,a]=p(s),t=o=>o.parentElement===n.current;return d(()=>{s.length&&a([...r,...s].filter(t))},s),d(()=>{if(!r.length)return;const o=new Set(r.map(c=>c.assignedSlot));o.delete(e.current);const l=[...o].map(c=>h(c,"slotchange",()=>a(i=>{const m=i.filter(t);return i.length===m.length?i:m})));return()=>l.map(c=>c())},r),r}const A=N(function({map:e}){const[u,n]=p([]),s=E(),r=x(s,t=>t instanceof HTMLElement);d(()=>{e&&(console.debug("YMap:useEffect",{map:e.toJSON()}),n(Array.from(e.entries())),e.observe(t=>{console.log("YMap:observe",{events:t,map:e.toJSON()}),n(Array.from(e.entries()))}))},[e]);function a(t){return console.log("YMap:getSharedProps",{Template:t,map:e.toJSON()}),t.getAttributeNames().filter(o=>o.startsWith(":")).reduce((o,l)=>{const c=l.replace(":",""),i=t.getAttribute(l);return o[c]=e.get(i||c),o},{})}return S("host",{shadowDom:!0,children:[f("template",{children:f("slot",{ref:s})}),r.map(t=>f(t,{cloneNode:!0,...a(t)}))]})},{props:{map:{type:Y,reflect:!1}},styles:g`:host{display:block}`});customElements.define("y-map",A);export{A as Y};
